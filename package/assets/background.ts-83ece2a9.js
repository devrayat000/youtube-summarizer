chrome.runtime.onMessage.addListener(r=>(r.type==="summarize_transcript"&&fetch(`https://devrayat000-youtube-summarizer.hf.space/youtube/${r.videoId}`).then(e=>{if(e.ok){const t=e.body;if(!t)throw new Error("no data");return t.getReader()}else throw e.text()}).then(e=>{const t=new TextDecoder;function n(){return e.read().then(({done:s,value:i})=>{if(s)return;const o=t.decode(i);return console.log(o),chrome.runtime.sendMessage({response:o}),n()})}n()}).catch(e=>{e instanceof Error?chrome.runtime.sendMessage({error:e.message}):typeof e=="string"&&/Could not retrieve a transcript/.test(e)?chrome.runtime.sendMessage({error:"Couldn't retrieve a transcript for the video."}):chrome.runtime.sendMessage({error:"Looks like OpenAI timed out :("})}),!0));
